---
title: Automatic Schematic Layout
---

:::warning
Automatic layout is in beta! We're changing and improving the layout algorithms,
if it doesn't work for you stay tuned! Many changes are on the way!
:::

:::info
Looking to aly out a PCB? Check out the [Automatic PCB Layout](./automatic-pcb-layout) guide.
:::


## Automatic Schematic Layout

Here's an example of a Pico-driven nine key keyboard with `schAutoLayoutEnabled`:

import CircuitPreview from "@site/src/components/CircuitPreview"


<CircuitPreview
  defaultView="schematic"
  code={`

import { SmdDiode } from "@tsci/seveibar.SmdDiode"
import { Key } from "@tsci/seveibar.Key"
import { Pico2 } from "@tsci/seveibar.pico2"

const rowToMicroPin = {
  0: "GP0",
  1: "GP1",
  2: "GP10",
}
const colToMicroPin = {
  0: "GP19",
  1: "GP17",
  2: "GP5",
}

export default () => (
  <board width="100mm" height="100mm" schTraceAutoLabelEnabled schAutoLayoutEnabled>
    <Pico2 name="U1" pcbX={-30} />
    {grid({ sizeX: 3, sizeY: 3, pitch: 19.05, offset: { x: 20, y: 0 } }).map(
      ({ x, y, row, col }, index) => {
        const schOffX = 5 + x/6
        const schOffY = -y / 8
        return (
          <group key={\`Kgroup\${index}\`}>
            <Key pcbX={x} pcbY={y} schX={schOffX} schY={schOffY + 0.5} name={\`K\${index + 1}\`} />
            <SmdDiode
              pcbX={x}
              pcbY={y - 13}
              layer="bottom"
              name={\`D\${index + 1}\`}
            />
            <trace from={\`.D\${index + 1} .pin1\`} to={\`.K\${index + 1} .pin1\`} />
            <trace
              from={\`.D\${index + 1} .pin2\`}
              to={\`.U1 .\${rowToMicroPin[row]}\`}
            />
            <trace
              from={\`.K\${index + 1} .pin2\`}
              to={\`.U1 .\${colToMicroPin[col]}\`}
            />
          </group>
        )
      }
    )}
  </board>
)

function grid(opts: {
  sizeX: number
  sizeY: number
  pitch: number
  offset?: { x: number; y: number }
}): Array<{ x: number; y: number; row: number; col: number }> {
  const { sizeX, sizeY, pitch, offset = { x: 0, y: 0 } } = opts
  const points: Array<{ x: number; y: number; row: number; col: number }> = []
  const startX = (-(sizeX - 1) * pitch) / 2
  const startY = (-(sizeY - 1) * pitch) / 2
  for (let row = 0; row < sizeY; row++) {
    for (let col = 0; col < sizeX; col++) {
      points.push({
        x: startX + col * pitch + offset.x,
        y: startY + row * pitch + offset.y,
        row,
        col,
      })
    }
  }
  return points
}

`}

/>

## Automatic PCB Layout

TSCircuit provides three main methods for automatic PCB layout, each suited for different use cases:

### pcbGrid Layout

Grid layout arranges components in a structured grid pattern. This is ideal for matrix keyboards, LED grids, or any regular array of components.

<CircuitPreview
  defaultView="pcb"
  hideCodeEditor
  code={`
export default () => (
  <board width="60mm" height="40mm" pcbAutoLayoutEnabled>
    <resistor name="R1" resistance="1k" pcbGrid={{ row: 0, col: 0 }} />
    <resistor name="R2" resistance="1k" pcbGrid={{ row: 0, col: 1 }} />
    <resistor name="R3" resistance="1k" pcbGrid={{ row: 0, col: 2 }} />
    <resistor name="R4" resistance="1k" pcbGrid={{ row: 1, col: 0 }} />
    <resistor name="R5" resistance="1k" pcbGrid={{ row: 1, col: 1 }} />
    <resistor name="R6" resistance="1k" pcbGrid={{ row: 1, col: 2 }} />
  </board>
)
`}
/>

You can customize the grid spacing and offset:

```tsx
<resistor 
  name="R1" 
  resistance="1k" 
  pcbGrid={{ 
    row: 0, 
    col: 0, 
    spacing: { x: 15, y: 10 },
    offset: { x: 5, y: 5 }
  }} 
/>
```

### pcbFlex Layout

Flex layout provides automatic spacing and alignment along a single axis, similar to CSS flexbox. Perfect for linear arrangements of components.

<CircuitPreview
  defaultView="pcb"
  hideCodeEditor
  code={`
export default () => (
  <board width="80mm" height="30mm" pcbAutoLayoutEnabled>
    <group pcbFlex pcbFlexGap="1mm">
      <resistor name="R1" resistance="1k" footprint="0402" />
      <capacitor name="C1" capacitance="100nF" footprint="0402" />
      <group pcbFlex pcbFlexDirection="column" pcbFlexGap="1mm">
        <resistor name="R2" resistance="10k" footprint="0402" />
        <capacitor name="C2" capacitance="1uF" footprint="0603" />
      </group>
    </group>
  </board>
)
`}
/>

You can customize the flex layout with additional options:

```tsx
<group 
  pcbLayout={{ 
    flex: true,
    direction: "column",
    gap: 2
  }}
>
  <resistor name="R1" resistance="1k" footprint="0402" />
  <resistor name="R2" resistance="2.2k" footprint="0402" />
</group>
```

### pcbPack Layout

Pack layout automatically places components to minimize space while avoiding overlaps. Ideal for dense layouts where space efficiency is crucial.

<CircuitPreview
  defaultView="pcb"
  hideCodeEditor
  code={`
export default () => (
  <board width="40mm" height="40mm" pcbAutoLayoutEnabled>
    <resistor name="R1" resistance="1k" pcbPack={{ priority: 1 }} />
    <resistor name="R2" resistance="2.2k" pcbPack={{ priority: 2 }} />
    <capacitor name="C1" capacitance="100nF" pcbPack={{ priority: 1 }} />
    <capacitor name="C2" capacitance="10uF" pcbPack={{ priority: 3 }} />
    <resistor name="R3" resistance="4.7k" pcbPack={{ priority: 2 }} />
    <capacitor name="C3" capacitance="1nF" pcbPack={{ priority: 1 }} />
  </board>
)
`}
/>

Pack layout options:

```tsx
<resistor 
  name="R1" 
  resistance="1k" 
  pcbPack={{ 
    priority: 1,        // Lower numbers placed first
    margin: 2,          // Minimum spacing around component
    anchor: "center"    // Anchor point for placement
  }} 
/>
```

### Combining Layout Methods

You can mix different layout methods within the same board for complex arrangements:

<CircuitPreview
  defaultView="pcb"
  hideCodeEditor
  code={`
export default () => (
  <board width="80mm" height="60mm" pcbAutoLayoutEnabled>
    {/* Grid layout for main components */}
    <resistor name="R1" resistance="1k" pcbGrid={{ row: 0, col: 0 }} />
    <resistor name="R2" resistance="1k" pcbGrid={{ row: 0, col: 1 }} />
    <resistor name="R3" resistance="1k" pcbGrid={{ row: 1, col: 0 }} />
    <resistor name="R4" resistance="1k" pcbGrid={{ row: 1, col: 1 }} />
    
    {/* Flex layout for supporting components */}
    <group pcbLayout={{ flex: true, direction: "column", gap: 3 }}>
      <capacitor name="C1" capacitance="100nF" footprint="0402" />
      <capacitor name="C2" capacitance="10nF" footprint="0402" />
    </group>
    
    {/* Pack layout for remaining components */}
    <resistor name="R5" resistance="10k" pcbPack={{ priority: 1 }} />
    <capacitor name="C3" capacitance="1uF" pcbPack={{ priority: 2 }} />
  </board>
)
`}
/>